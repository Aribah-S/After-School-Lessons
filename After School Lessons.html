<html>
    <head>
        <title>After School Lessons</title> 
        <!-- Load Vue.js from a server (so no local file is needed) -->
        <script src="https://unpkg.com/vue@2.7.8/dist/vue.js"></script>
        <link rel="stylesheet" href="style.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    </head>
    <body>
        <!-- The element where Vue wil mount -->
         <div id="app">
            <header>
                <h1>{{sitename}}</h1>
                <button v-on:click='showCheckout'>
                       <!-- 'cartItemCount' is used the same way as a datay property. -->
                        {{ cartItemCount }}
                        <!-- add the cart icon -->
                         <span class="fas fa-cart-plus"></span> Checkout
                </button>
            </header>
            <main>
                  <div v-if='showProduct'>
                        <!-- the code for the product page -->
                    <figure>
                        <!-- bind 'src' attr to 'product.image' in 'data' -->
                         <img v-bind:src="product.image">
                    </figure>
                    <h2 v-text="product.title"></h2>
                    <p v-text="product.description"></p>

                    <!-- The double curly brackets is used instead of 'v-text'-->
                     <p>Price: {{product.price}}</p>
                      <!-- This buttong will be displayed when 'canAddToCart' is true -->
                     <button v-on:click="addToCart" v-if="canAddToCart">
                        Add to cart
                     </button>
                     <span v-if='itemsLeft  === 0'>All out!</span>
                     <span v-if="itemsLeft < 5">Only {{itemsLeft}} left! </span>
                     <span v-else>Buy now!</span>
                     <div> 
                        <span v-for='n in product.rating'>★</span>
                        <span v-for='n in 5 - product.rating'>☆</span>
                     </div>

                     <!-- This button will be displayed otherwise -->
                     <button disabled='disabled' v-else>
                        Add to cart
                     </button>
                   </div>
                   <div v-else>
                        <!-- the code for the checkout page -->
                         <h2>Checkout</h2>
                         <p>
                            <strong>First Name:</strong>
                            <!-- This input field is bound to 'firstName' in the 'order' object -->
                            <input v-model.trim="order.firstName"/>
                         </p>
                         <p>
                            <strong>Last Name:</strong>
                            <!-- This input field is bound to 'lastName' in the 'order' object -->
                            <input v-model.trim="order.lastName"/>
                         </p>   
                            <p> 
                                <strong>Address:</strong> <input v-model="order.address"/>
                            </p>
                            <p>
                                <strong>City:</strong> <input v-model="order.city"/>
                            </p>
                            <p>
                                <strong>State:</strong>
                                <select v-model="order.state">
                                    <option disabled value="">State</option>
                                    <option v-for=" (state, key) in states"
                                    v-bind:value="state">
                                    {{key}}
                                </option>
                                    <option value="Alabama">AL</option>
                                    <option value="Arizona">AR</option>
                                    <option value="California">CA</option>
                                    <option value="Nevada">NV</option>
                                </select>
                            </p>
                            <p>
                                <strong>Zip/Postal Code:</strong> <input v-model.number="order.zip" type="number"/>
                            </p>
                            <p><input type="checkbox" id="gift" value="true" v-model="order.gift"
                                v-bind:true-value="order.sendGift"
                                v-bind:false-value="order.dontSendGift"/>
                            <label for="gift">Ship as a gift?</label></p>

                            <p><input type="radio" id="home" value="Home" v-model="order.method"/>
                            <label for="home">Home</label>
                            <input type="radio" id="business" value="Business" v-model="order.method"/>
                            <label for="business">Business</label></p>
                        <h2>Order Information</h2>
                        <p>First Name: {{order.firstName}}</p>
                        <p>Last Name: {{order.lastName}}</p>
                        <p>Address: {{order.address}}</p>
                        <p>City: {{order.city}}</p>
                        <p>Zip: {{order.zip}}</p>
                        <p>State: {{order.state}}</p>
                        <p>Gift: {{order.gift}}</p>
                        <p>Method: {{order.method}}</p>
                    <button v-on:click="submitForm">Place Order</button>
                   </div>
            </main>
         </div>
        <script type="text/javascript">
                var webstore = new Vue({ // The Vue instance
                        el: '#app', // The 'option object': DOM mounting point
                        data: { // the 'data' option
                                // the key 'sitename' matches the value of 'v-text' earlier
                                sitename: 'After School Lessons',
                                showProduct: true,
                                product: {
                                    id: 1001,
                                    title: 'Game Development',
                                    description: 'Learn how to use unreal engine to develop your own video game of any genre!',
                                    price: 200,
                                    image: "images/game.webp",
                                    availableInventory: 10, // was 5
                                    rating: 3,
                                    cart: [], // array to store items in shopping cart
                                    order: {
                                        firstName: '',
                                        lastName: '',
                                        address: '',
                                        city: '',
                                        zip: '',
                                        state: '',
                                        method: 'Home',
                                        gift: false,
                                        sendGift: 'Send as a gift',
                                        dontSendGift: 'Do not send as a gift',
                                    },
                                    states: {
                                        AL: 'Alabama',
                                        AR: 'Arizona',
                                        CA: 'California',
                                        NV: 'Nevada'
                                    },
                                },
                                
                             },
                        methods: {
                            addToCart: function() {
                                this.cart.push(this.product.id);
                            },
                            showCheckout() {
                                this.showProduct = !this.showProduct; 
                            },
                            submitForm() {
                                alert('Order submitted!')
                            },
                        },
                        computed: { // the Computed Property object
                              cartItemCount: function() { // the property name 
                                       // its value is calculated when its called
                                       return this.cart.length;
                                    },
                              canAddToCart: function() {
                                    return this.product.availableInventory > this.cartItemCount;
                                    },
                              itemsLeft() {
                                return this.product.availableInventory - this.cartItemCount;
                              }
                       },
                });
        </script>
    </body>
</html>